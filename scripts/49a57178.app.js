riot.tag("google-analytics","",function(a){!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-65290596-1","auto"),ga("send","pageview")}),riot.tag("pager",'<nav><ul class="pager"><li class="{previous: true, disabled: isDisablePreviousBtn}" ><a href="javascript:void(0);" onclick="{onClickBeforePage}" ><span aria-hidden="true">&larr;</span> 前へ</a></li><li class="{next:true, disabled: isDisableNextBtn}"><a href="javascript:void(0);" onclick="{onClickNextPage}">次へ <span aria-hidden="true">&rarr;</span></a></li></ul></nav>',function(a){var b=this;this.isDisablePreviousBtn=!1,this.isDisableNextBtn=!1,this.onClickBeforePage=function(){b.isDisablePreviousBtn||a.listener.onPageChange(a.result.pageNo-1)}.bind(this),this.onClickNextPage=function(){b.isDisableNextBtn||a.listener.onPageChange(a.result.pageNo+1)}.bind(this),this.on("update",function(){b.isDisablePreviousBtn=0===a.result.pageNo,b.isDisableNextBtn=a.result.total<=a.result.limit*(a.result.pageNo+1)})}),riot.tag("typeform","",function(a){!function(){var a,b,c,d,e=document,f=e.getElementById,g=e.createElement,h=e.getElementsByTagName,i="typef_orm",j="https://s3-eu-west-1.amazonaws.com/share.typeform.com/";f.call(e,i)||(b=g.call(e,"script"),b.id=i,b.src=j+"share.js",c=h.call(e,"script")[0],c.parentNode.insertBefore(b,c)),i+="_",f.call(e,i)||(a=g.call(e,"link"),a.rel="stylesheet",a.id=i,a.href=j+"share-button.css",d=h.call(e,"head")[0],d.appendChild(a,d))}()}),riot.tag("about",'<article class="content matsuri-style"><section id="about-introduction"><img src="/images/5cd16272.facebook.jpg"><p>本サービスは、千葉市で長い間親しまれているお祭りについて、お知らせする無料サービスです。</p><p>いつ、どこで、どんなお祭りが行われるのか、ひと目でわかるように情報をまとめました。</p><p>ご家族で、お友だち同士で、もちろんおひとりでも大丈夫。</p><p>千葉市のそこかしこで賑わうお祭りに繰り出して、みんなで千葉市を元気にしましょう。</p></section><section id="about-source"><h1>お祭り情報について</h1><p>各地域のお祭り情報は、千葉市が公開するオープンデータを使用しています。</p><p>今後はこちらに独自の情報を追加してデータベースを拡充していく予定です。</p></section><section id="about-navi"><p><a href="javascript:void(0)" onclick="{doHome}"> トップへ戻る </a></p></section></article>','about section, [riot-tag="about"] section{ width: 600px; margin: 0 auto; } about section + section, [riot-tag="about"] section + section{ margin-top: 30px; } about section img, [riot-tag="about"] section img{ width: 600px; margin-bottom: 30px; } about section h1, [riot-tag="about"] section h1{ text-align: center; margin-bottom: 26px; } about section p, [riot-tag="about"] section p{ line-height: 2.0; margin-bottom: 12px; text-align: center; } about #about-introduction h1, [riot-tag="about"] #about-introduction h1{ font-size: 26px; } about #about-source h1, [riot-tag="about"] #about-source h1{ font-size: 22px; } about #about-navi p, [riot-tag="about"] #about-navi p{ text-align: center; padding-bottom: 40px; } @media only screen and (max-width: 640px){ about section, [riot-tag="about"] section{ width: auto; } about section img, [riot-tag="about"] section img{ width: 100%; } about section p, [riot-tag="about"] section p{ line-height: 2.0; margin: 0 10px 12px; text-align: left; } }',function(a){this.doHome=function(a){riot.route("#home")}.bind(this)}),riot.tag("app","<app-header></app-header><home show=\"{path === 'home'}\"></home><search show=\"{path === 'search'}\"></search><fes-detail show=\"{path === 'detail'}\"></fes-detail><about show=\"{path === 'about'}\"></about><credit show=\"{path === 'credit'}\"></credit><app-footer></app-footer>",function(a){var b=this;this.path=null,this.fes=null,riot.route.on("routeChange",function(a){b.path=a,b.update()})}),riot.tag("app-header",'<header><div class="header-content"><h1><a class="roll_fout" href="#"><img src="images/common/04c504f7.logo.png" alt="千葉市お祭りデータセンター"></a></h1></div></header>','app-header header, [riot-tag="app-header"] header{ background-color: #fff; } app-header h1, [riot-tag="app-header"] h1{ padding: 10px 0px; } app-header .header-content, [riot-tag="app-header"] .header-content{ width: 1000px; margin: 0 auto; } @media only screen and (max-width: 640px){ app-header h1, [riot-tag="app-header"] h1{ padding: 10px 0px 10px 10px; } app-header h1 img, [riot-tag="app-header"] h1 img{ width: 70%; } app-header .header-content, [riot-tag="app-header"] .header-content{ width: 100%; } }',function(a){}),riot.tag("app-footer",'<footer><ul class="clearfix matsuri-style"><li><a href="javascript:void(0)" onclick="{showAbout}">このサービスについて</a></li><li><a href="javascript:void(0)" onclick="{showCredit}">クレジット</a></li><li><a href="https://codeforchiba.typeform.com/to/qzQYxn" class = "typeform-share link" target = "_blank" data-mode = "1">問い合わせ</a></li><li><a href="https://codeforchiba.typeform.com/to/tpiHfF" class = "typeform-share link" target = "_blank" data-mode = "1">お祭りデータの登録依頼</a></li></ul><p><a href="http://code4chiba.org/"><img src="images/common/403c5bdd.codeforchiba.gif" alt="Code For Chiba"></a></p></footer><google-analytics></google-analytics><typeform></typeform>','app-footer footer, [riot-tag="app-footer"] footer{ background: #fff url(images/common/dc1f9a34.footer-line.gif) left top repeat-x; padding-top: 30px; } app-footer ul, [riot-tag="app-footer"] ul{ width: 600px; margin: 10px auto 30px; } app-footer li, [riot-tag="app-footer"] li{ float: left } app-footer li + li, [riot-tag="app-footer"] li + li{ margin-left: 30px; } app-footer p, [riot-tag="app-footer"] p{ text-align: center; } app-footer .copyright, [riot-tag="app-footer"] .copyright{ background: #2c2c2c; padding: 10px 0; color: #fff; margin-bottom: 0; } app-footer .copyright a, [riot-tag="app-footer"] .copyright a{ color: #ddd; } @media only screen and (max-width: 640px){ app-footer footer, [riot-tag="app-footer"] footer{ background: #fff url(images/common/dc1f9a34.footer-line.gif) left top repeat-x; } app-footer ul, [riot-tag="app-footer"] ul{ width: auto; } app-footer li, [riot-tag="app-footer"] li{ float: none; text-align: center; line-height: 2.0; } app-footer li + li, [riot-tag="app-footer"] li + li{ margin-left: 0; } app-footer p, [riot-tag="app-footer"] p{ text-align: center; } app-footer p img, [riot-tag="app-footer"] p img{ width: 50%; } app-footer p.copyright img, [riot-tag="app-footer"] p.copyright img{ width: auto; } app-footer .copyright, [riot-tag="app-footer"] .copyright{ background: #2c2c2c; padding: 20px 0; color: #fff; } }',function(a){this.showAbout=function(a){riot.route("about")}.bind(this),this.showCredit=function(a){riot.route("credit")}.bind(this)}),riot.tag("credit",'<article class="content"><section id="credit-list"><h1 class="matsuri-style">クレジット</h1><h2 class="matsuri-style">企画</h2><ul class="clearfix"><li><member uuid="6735387e-450f-44ee-9ced-91ae797c0c97"></member></li><li><member uuid="029a587a-a2bd-412a-ac02-35f49bb70995"></member></li><li><member uuid="cfb8d07e-464b-43f0-810f-a3ccba08b3e6"></member></li></ul><ul class="clearfix"><li>OGAWA Junichi</li><li>OKAMOTO Naomi</li><li>TAKAHASHI Fumiki</li><li>YAMAMOTO Munehiro</li><li>SHIMIZU Yasuo</li></ul><h2 class="matsuri-style">エンジニア</h2><ul class="clearfix"><li><member uuid="ddb396bd-dc7b-4d20-ae7a-df2e2470c377"></member></li><li><member uuid="957c87fc-b968-463e-99d1-a6f18a065c83"></member></li><li><member uuid="5ed8ae73-f571-4bd4-8707-7e76456ecc65"></member></li><li><member uuid="8c633cf3-fb3c-4710-86cb-6bce874d98c0"></member></li></ul><h2 class="matsuri-style">デザイナー</h2><ul class="clearfix"><li><member uuid="aebfcc03-ead7-445c-9e41-f78ae07fd2ce"></member></ul><h2 class="matsuri-style">アドバイザー</h2><ul class="clearfix"><li><member uuid="b9010dbd-ef0b-484a-a64b-6c7ee0baf73f"></member></li><li><member uuid="0dc3fb03-c899-422b-ac79-23c650bda893"></member></li></ul><ul class="clearfix"><li>SAGARA Toshihiro</li><li>MURAKAWA Akihisa</li></ul></section><section id="credit-navi"><p class="matsuri-style"><a href="javascript:void(0)" onclick="{doHome}"> トップへ戻る </a></p></section></article>','credit section, [riot-tag="credit"] section{ width: 600px; margin: 0 auto; } credit section + section, [riot-tag="credit"] section + section{ margin-top: 30px; } credit section h1, [riot-tag="credit"] section h1{ text-align: center; font-size: 26px; margin-bottom: 26px; } credit section h2, [riot-tag="credit"] section h2{ text-align: center; font-size: 22px; } credit section p, [riot-tag="credit"] section p{ line-height: 2.0; margin-bottom: 12px; text-align: center; } credit section ul, [riot-tag="credit"] section ul{ width: 600px; margin: 16px auto; } credit section li, [riot-tag="credit"] section li{ float: left; width: 300px; text-align: center; font-size: 14px; line-height: 2.0; } credit section li:nth-child(2n) iframe, [riot-tag="credit"] section li:nth-child(2n) iframe{ margin-left: 10px; } credit section li:hover, [riot-tag="credit"] section li:hover{ cursor: pointer; color: #F93; } credit #credit-navi p, [riot-tag="credit"] #credit-navi p{ text-align: center; padding-bottom: 40px; } @media only screen and (max-width: 640px){ credit section, [riot-tag="credit"] section{ width: auto; } credit section ul, [riot-tag="credit"] section ul{ width: auto; } credit section li, [riot-tag="credit"] section li{ float: none; width: auto; } credit section li:nth-child(2n) iframe, [riot-tag="credit"] section li:nth-child(2n) iframe{ margin-left: 0; } }',function(a){this.doHome=function(a){riot.route("#home")}.bind(this)}),riot.tag("home",'<div class="main"><div class="main-img"><img src="images/home/31ad2c57.main.jpg" alt="千葉市お祭りデータセンター"></div></div><article class="content"><section class="homesearch"><div class="homesearch-list"><a href="javascript:void(0)" onclick="{doClickCitySearchPanel}"><img src="images/home/fcec89ac.icon01.svg"><p class="matsuri-style">地域から探す</p></a></div><div class="homesearch-list"><a href="javascript:void(0)" onclick="{doSearchToday}"><img src="images/home/be0e5f45.icon02.svg"><p class="matsuri-style">本日開催の祭り</p></a></div><div class="homesearch-list"><a href="javascript:void(0)" onclick="{doSearchThisWeekEnd}"><img src="images/home/7843840a.icon03.svg"><p class="matsuri-style">土日開催の祭り</p></a></div></section><section id="city-search" style="display:none"><ul class="homesearch matsuri-style"><li class="homesearch-list" each="{city in cities}"><a href="javascript:void(0)" onclick="{parent.doSearchCity}"><p>{city.city}</p><p>{parent.fesCount[city.cityCode]}件</p></a></li></ul></section><section class="week"><dl class="week-day"><dt class="matsuri-style">今週開催の祭り</dt><dd>{moment(startDateOfWeek).format(\'M/D\')} - {moment(endDateOfWeek).format(\'M/D\')}</dd></dl><div class="week-map"><fes-map feslist="{fesList}"></fes-map></div><fes-list feslist="{fesList}"></fes-list></section></article>','home .homesearch, [riot-tag="home"] .homesearch{ background: #f5ac42; margin-bottom: 30px; } home .homesearch .homesearch-list, [riot-tag="home"] .homesearch .homesearch-list{ float: left; width: 33.2%; border-right: #cb7e01 solid 1px; font-size: 20px; font-weight: bold; text-align: center; } home .homesearch .homesearch-list:nth-child(3n), [riot-tag="home"] .homesearch .homesearch-list:nth-child(3n){ border-right: 0px; } home .homesearch .homesearch-list a, [riot-tag="home"] .homesearch .homesearch-list a{ display: block; color: #fff; padding: 20px 0px; text-decoration: none; } home .homesearch .homesearch-list a img, [riot-tag="home"] .homesearch .homesearch-list a img{ width: 100px; } home .homesearch .homesearch-list a p, [riot-tag="home"] .homesearch .homesearch-list a p{ margin-bottom: 0px; } home .homesearch .homesearch-list a:hover, [riot-tag="home"] .homesearch .homesearch-list a:hover{ background: #ff9700; } home .homesearch .homesearch-list:last-child, [riot-tag="home"] .homesearch .homesearch-list:last-child{ border-right: none; } home .homesearch #city-search .homesearch-list, [riot-tag="home"] .homesearch #city-search .homesearch-list{ display: inline-block; float: none; border-top: #cb7e01 solid 1px; } home .homesearch:after, [riot-tag="home"] .homesearch:after{ content: "."; display: block; height: 0; font-size: 0; clear: both; visibility: hidden; } home #city-search .homesearch-list, [riot-tag="home"] #city-search .homesearch-list{ border-top: #cb7e01 solid 1px; } home #city-search .homesearch-list:nth-child(1), [riot-tag="home"] #city-search .homesearch-list:nth-child(1),home #city-search .homesearch-list:nth-child(2), [riot-tag="home"] #city-search .homesearch-list:nth-child(2),home #city-search .homesearch-list:nth-child(3), [riot-tag="home"] #city-search .homesearch-list:nth-child(3){ border-top: 0; } home .week .week-day, [riot-tag="home"] .week .week-day{ margin-bottom: 30px; } home .week .week-day dt, [riot-tag="home"] .week .week-day dt{ font-size: 20px; font-weight: bold; text-align: center; } home .week .week-day dd, [riot-tag="home"] .week .week-day dd{ font-size: 36px; font-family: sans-serif; text-align: center; padding-bottom: 20px; font-weight: 400; font-family: \'Merriweather\', serif; letter-spacing: 0.1em; background: url(images/common/00b976b5.week-day-bg01.gif) top 18px left 200px no-repeat, url(images/common/00b976b5.week-day-bg01.gif) top 18px right 200px no-repeat, url(images/common/12771e09.week-day-bg02.gif) center bottom 0px no-repeat; } home .week .week-map, [riot-tag="home"] .week .week-map{ margin-bottom: 30px; } home .week .week-map #map-result, [riot-tag="home"] .week .week-map #map-result{ height: 240px; width: 100%; } @media only screen and (max-width: 640px){ home .homesearch .homesearch-list, [riot-tag="home"] .homesearch .homesearch-list{ width: 33.1%; font-size: 14px; } home .homesearch .homesearch-list a, [riot-tag="home"] .homesearch .homesearch-list a{ padding: 10px 0px; } home .homesearch .homesearch-list a img, [riot-tag="home"] .homesearch .homesearch-list a img{ width: 40%; } home .week .week-day dt, [riot-tag="home"] .week .week-day dt{ font-size: 14px; } home .week .week-day dd, [riot-tag="home"] .week .week-day dd{ font-size: 28px; background: url(images/common/00b976b5.week-day-bg01.gif) top 11px left -60px no-repeat, url(images/common/00b976b5.week-day-bg01.gif) top 11px right -60px no-repeat, url(images/common/12771e09.week-day-bg02.gif) center bottom 0px no-repeat; } }',function(a){var b=this;this.fesList=[],this.cities=[],this.fesCount={a:"b"},0===moment().weekday()?(this.startDateOfWeek=moment().weekday(-6).toDate(),this.endDateOfWeek=moment().toDate()):(this.startDateOfWeek=moment().weekday(1).toDate(),this.endDateOfWeek=moment().weekday(7).toDate()),this.doClickCitySearchPanel=function(a){$(b["city-search"]).slideToggle()}.bind(this),this.doSearchToday=function(a){var b=moment().format("YYYY-MM-DD"),c={fromDate:b,toDate:b};riot.route("search/list?"+$.param(c))}.bind(this),this.doSearchThisWeekEnd=function(a){var b;b=0===moment().weekday()?{fromDate:moment().weekday(-1).format("YYYY-MM-DD"),toDate:moment().format("YYYY-MM-DD")}:{fromDate:moment().weekday(6).format("YYYY-MM-DD"),toDate:moment().weekday(7).format("YYYY-MM-DD")},riot.route("search/list?"+$.param(b))}.bind(this),this.doSearchCity=function(a){var b=moment().format("YYYY-MM-DD"),c={fromDate:b,cities:[a.item.city.cityCode]};riot.route("search/list?"+$.param(c))}.bind(this),riot.route.on("home",function(a){b.tags["fes-map"].trigger("show");var c={fromDate:b.startDateOfWeek,toDate:b.endDateOfWeek,order:"periods"};cfc.Event.find(c).done(function(a){b.fesList=a.list,b.update()}),cfc.City.findAllWards().then(function(a){b.cities=a;var c=_.map(a,function(a){var c={fromDate:new Date,cities:[a.cityCode]};return cfc.Event.find(c).done(function(c){b.fesCount[a.cityCode]=c.total})});$.when.apply($,c).done(function(){b.update()})})})}),riot.tag("member",'<iframe riot-src="https://cfc-directory.herokuapp.com/embed/{opts.uuid}" scrolling="no" frameborder="no"></iframe>','member iframe, [riot-tag="member"] iframe{ width: 300px; height: 120px; overflow: hidden; border-radius: 5px; border: 1px solid rgb(240, 240, 240); }',function(a){}),riot.tag("search",'<div class="main"><div class="main-img"><h2 class="matsuri-style">祭りを検索する</h2><img src="images/home/31ad2c57.main.jpg" alt="千葉市お祭りデータセンター"></div></div><article class="content"><form onsubmit="{onSubmitSearch}"><h4 class="matsuri-style">期間を選択してください。</h4><div class="form-group row"><div class="col-xs-6"><input type="text" class="form-control" id="fromDate" ></div><div class="col-xs-6"><input type="text" class="form-control" id="toDate" ></div></div><h4 class="matsuri-style">地域を選択してください。</h4><div class="form-group"><select class="form-control" id="cities"></select></div><div class="form-group btn-area"><button type="submit" class="btn btn-search matsuri-style">検索する</button></div></form><section class="result"><ul class="tab"><li class="{\'tab-item\': true, active: path===\'list\'}"><a href="#search/list?{queryString}"><img src="images/search/7d56a92a.icon01.svg"><p class="matsuri-style">一覧</p></a></li><li class="{\'tab-item\': true, active: path===\'map\'}"><a href="#search/map?{queryString}"><img src="images/search/7966085c.icon02.svg"><p class="matsuri-style">地図</p></a></li><li class="{\'tab-item\': true, active: path===\'cal\'}"><a href="#search/cal?{queryString}"><img src="images/search/9b96e6ed.icon03.svg"><p class="matsuri-style">カレンダー</p></a></li></ul><div><search-list show="{path===\'list\'}" request="{request}" ></search-list><search-map show="{path===\'map\'}" request="{request}" ></search-map><search-calendar show="{path===\'cal\'}" request="{request}" ></search-calendar></div></section></article>','search .main .main-img h2, [riot-tag="search"] .main .main-img h2{ position: absolute; top: 80px; left: 0px; font-size: 36px; color: #fff; padding: 10px; padding-left: 20px; background-color: rgba(51, 51, 51, 0.6); } search .content, [riot-tag="search"] .content{ position: relative; } search form, [riot-tag="search"] form{ padding: 20px 20px 0px 20px; background-color: rgba(255, 255, 255, 0.8); border: 2px solid #f5ac42; } search form .btn-area, [riot-tag="search"] form .btn-area{ text-align: center; } search form .btn-search, [riot-tag="search"] form .btn-search{ background-color: #3bb3e0; padding: 10px; position: relative; text-decoration: none; color: #fff; width: 100px; border: none; margin-bottom: 30px; background-image: linear-gradient(bottom, #2ca0ca 0%, #3eb8e5 100%); background-image: -webkit-linear-gradient(bottom, #2ca0ca 0%, #3eb8e5 100%); background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #2ca0ca), color-stop(1, #3eb8e5)); -o-box-shadow: inset 0px 1px 0px #7fd2f1, 0px 6px 0px #156785; box-shadow: inset 0px 1px 0px #7fd2f1, 0px 6px 0px #156785; border-radius: 5px; } search form .btn-search:active, [riot-tag="search"] form .btn-search:active{ color: #156785; text-shadow: 0px 1px 1px rgba(255, 255, 255, 0.3); background: #2ca0ca; -o-box-shadow: inset 0px 1px 0px #7fd2f1, inset 0px -1px 0px #156785; box-shadow: inset 0px 1px 0px #7fd2f1, inset 0px -1px 0px #156785; top: 7px; } search form .btn:active:before, [riot-tag="search"] form .btn:active:before{ top: -2px; } search form .btn:hover, [riot-tag="search"] form .btn:hover{ color: #fff; } search .tab, [riot-tag="search"] .tab{ background: #D75247; margin-bottom: 30px; } search .tab .tab-item, [riot-tag="search"] .tab .tab-item{ float: left; width: 33.1%; border-right: #8B332C solid 1px; font-size: 20px; font-weight: 700; text-align: center; } search .tab .tab-item a, [riot-tag="search"] .tab .tab-item a{ display: block; color: #fff; padding: 20px 0; text-decoration: none; } search .tab .tab-item a img, [riot-tag="search"] .tab .tab-item a img{ width: 100px; } search .tab .tab-item a p, [riot-tag="search"] .tab .tab-item a p{ margin-bottom: 0; } search .tab .tab-item a:hover, [riot-tag="search"] .tab .tab-item a:hover,search .tab .tab-item.active a, [riot-tag="search"] .tab .tab-item.active a{ background: #BB463C; } search .tab .tab-item:last-child, [riot-tag="search"] .tab .tab-item:last-child,search .tab .tab-item:nth-of-type(3n), [riot-tag="search"] .tab .tab-item:nth-of-type(3n){ border-right: none; } search .tab:after, [riot-tag="search"] .tab:after{ content: "."; display: block; height: 0; font-size: 0; clear: both; visibility: hidden; } @media all and (min-width: 641px){ search form, [riot-tag="search"] form{ box-shadow: 0px 0px 10px; position: absolute; top: -270px; right: 50px; } } @media only screen and (max-width: 640px){ search .main .main-img h2, [riot-tag="search"] .main .main-img h2{ top: 40px; font-size: 26px; padding-left: 10px; } search form, [riot-tag="search"] form{ padding: 10px 10px 0px 10px; margin-left: 0px; margin-right: 0px; background-color: #f5ac42; border: none; } search form h4, [riot-tag="search"] form h4{ font-size: 13px; color: #fff; } search form .btn-search, [riot-tag="search"] form .btn-search{ padding: 10px; position: relative; text-decoration: none; color: #fff; width: 100%; border: none; background-image: linear-gradient(bottom, #C53333 0%, #ED6060 100%); background-image: -webkit-linear-gradient(bottom, #C53333 0%, #ED6060 100%); background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #C53333), color-stop(1, #ED6060)); -o-box-shadow: inset 0px 1px 0px #BB3535, 0px 6px 0px #901818; box-shadow: inset 0px 1px 0px #BB3535, 0px 6px 0px #901818; border-radius: 5px; } search form .btn-search:active, [riot-tag="search"] form .btn-search:active{ background: #C53333; color: #999; -o-box-shadow: inset 0px 1px 0px #BB3535, 0px -1px 0px #901818; box-shadow: inset 0px 1px 0px #BB3535, 0px -1px 0px #901818; top: 7px; } search form .btn-area, [riot-tag="search"] form .btn-area{ margin-bottom: 0; } search .tab, [riot-tag="search"] .tab{ margin-bottom:0px; } search .tab .tab-item, [riot-tag="search"] .tab .tab-item{ font-size: 16px; } }',function(a){var b=this,c={format:"yyyy/mm/dd",language:"ja",orientation:"top",todayHighlight:!0,autoclose:!0,clearBtn:!0,weekStart:1};this.$fromDate=$(this.fromDate).datepicker(c),this.$toDate=$(this.toDate).datepicker(c),this.$cities=$(this.cities),this.request=riot.observable(),this.path=null,this.queryString=null,cfc.City.findAllWards().then(function(a){var c=[];c.push($("<option value=''>-</option>")),_.each(a,function(a){c.push($("<option value='"+a.cityCode+"'>"+a.city+"</option>"))}),b.$cities.append(c)}),this.onSubmitSearch=function(a){var b=riot.route.currentPath(),c={fromDate:this.$fromDate.val().replace(/\//g,"-"),toDate:this.$toDate.val().replace(/\//g,"-"),cities:[this.$cities.val()]};b+="?"+$.param(c),riot.route(b)}.bind(this),riot.route.on("routeChange:search",function(a){b.path=a,b.update()}),riot.route.on("search",function(a){b.queryString=$.param(a),a.fromDate?b.$fromDate.datepicker("update",new Date(a.fromDate)):b.$fromDate.datepicker("clearDates"),a.toDate?b.$toDate.datepicker("update",new Date(a.toDate)):b.$toDate.datepicker("clearDates"),a.cities&&a.cities.length>0?b.$cities.val(a.cities[0]):b.$cities.val(""),b.update()})}),riot.tag("search-list",'<fes-list feslist="{result.list}"></fes-list>',function(a){var b=this;this.result={},this.searchParam={},this.onSelectFes=function(a){riot.route("detail/"+a.item.fes.id)}.bind(this),this.listener={onPageChange:function(a){var c=b.searchParam.fromDate,d=b.searchParam.toDate,e={fromDate:c?moment(c).format("YYYY-MM-DD"):null,toDate:d?moment(d).format("YYYY-MM-DD"):null,pageNo:a};riot.route("search/list?"+$.param(e))}},riot.route.on("search/list",function(a){var c={pageNo:a.pageNo||0,fromDate:a.fromDate?new Date(a.fromDate):null,toDate:a.toDate?new Date(a.toDate):null,cities:a.cities,order:"periods"};cfc.Event.find(c).done(function(a){b.result=a,b.update()})})}),riot.tag("search-map",'<fes-map feslist="{feslist}"></fes-map>','search-map #map-result, [riot-tag="search-map"] #map-result{ height: 500px; }',function(a){var b=this;this.feslist=[],riot.route.on("search/map",function(a){b.tags["fes-map"].trigger("show");var c={fromDate:a.fromDate?new Date(a.fromDate):null,toDate:a.toDate?new Date(a.toDate):null,cities:a.cities};cfc.Event.find(c).done(function(a){b.feslist=a.list,b.update()})})}),riot.tag("search-calendar",'<div id="calendar"></div>','search-calendar .fc-event, [riot-tag="search-calendar"] .fc-event{ margin-bottom: 5px; padding: 5px; cursor: pointer; } search-calendar .fc-event:hover, [riot-tag="search-calendar"] .fc-event:hover{ opacity: 0.8; } search-calendar .fc-event .fc-content, [riot-tag="search-calendar"] .fc-event .fc-content{ white-space: normal; } search-calendar .fc-event .fc-content .fc-time, [riot-tag="search-calendar"] .fc-event .fc-content .fc-time{ display: block; } search-calendar .fc-sat, [riot-tag="search-calendar"] .fc-sat{ background-color:#FFF5F5; } search-calendar .fc-sun, [riot-tag="search-calendar"] .fc-sun{ background-color:#FFF5F5; } search-calendar .fc-event .fc-toolbar .fc-left, [riot-tag="search-calendar"] .fc-event .fc-toolbar .fc-left,search-calendar .fc-event .fc-day-header, [riot-tag="search-calendar"] .fc-event .fc-day-header,search-calendar .fc-event .fc-content, [riot-tag="search-calendar"] .fc-event .fc-content{ font-family: "勘亭流",Kanteiryu,"ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,"ＭＳ Ｐゴシック",arial,helvetica,clean,sans-serif; } search-calendar .fc-event .fc-toolbar, [riot-tag="search-calendar"] .fc-event .fc-toolbar,search-calendar .fc-left, [riot-tag="search-calendar"] .fc-left{ font-size: 15px; }',function(a){var b=$(this.calendar);b.fullCalendar({lang:"ja",timezone:"local",firstDay:2,eventClick:function(a,b,c){return riot.route("detail/"+a.fes.id),!1}}),riot.route.on("search/cal",function(a){var b={fromDate:a.fromDate?new Date(a.fromDate):null,toDate:a.toDate?new Date(a.toDate):null,cities:a.cities};cfc.Event.find(b).done(c)});var c=function(a){var c=_.map(a.list,function(a){return{title:a.name,start:a.getStartDate().getTime(),end:a.getEndDate().getTime(),fes:a}});b.fullCalendar("render"),b.fullCalendar("removeEvents"),b.fullCalendar("addEventSource",c)}}),riot.tag("fes-detail",'<div if="{fes != null}"><div class="main"><div class="main-img"><img src="images/home/31ad2c57.main.jpg" alt="千葉市お祭りデータセンター"></div></div><article class="content"><div class="info-area"><h4 class="detail-title matsuri-style">{fes.name}</h4><ul class="day-time"><li each="{period, i in fes.periods}"><span class="date">{moment(period.start).format(\'MM/DD\')}</span><span class="{matsuri-style:true,day-of-week:true,sat:6===period.start.getDay(),sun:0===period.start.getDay()}">{moment(period.start).format(\'dd\')}</span><span class="clock"><span if="{moment(period.start).format(\'HH:mm\') != \'00:00\'}">{moment(period.start).format(\'HH:mm\')}</span><span if="{moment(period.end).format(\'HH:mm\') != \'00:00\'}"> - {moment(period.end).format(\'HH:mm\')}</span></span></li></ul><div class="weather"><ul><li each="{period, i in fes.periods}"><div class="date">{moment(period.start).format(\'MM/DD\')}</div><div><span if="{period.weather.weatherCode != null}" class="icon-weather c{period.weather.weatherCode}"></span><span if="{period.weather == null || period.weather.weatherCode == null}" class="icon-weather none"></span></div><div><span if="{period.weather.weather != null}">{period.weather.weather}</span><span if="{period.weather == null || period.weather.weather == null}">--</span></div><div><span if="{period.weather.temperatureMax != null}" class="temperatureMax">{period.weather.temperatureMax}</span><span if="{period.weather == null || period.weather.temperatureMax == null}">--</span> / <span if="{period.weather.temperatureMin != null}" class="temperatureMin">{period.weather.temperatureMin}</span><span if="{period.weather == null || period.weather.temperatureMin == null}">--</span></div><div><span if="{period.weather.precipitation != null}">{period.weather.precipitation}%</span><span if="{period.weather == null || period.weather.precipitation == null}">--</span></div></li></ul></div><div class="features"><img if="{fes.features.dancing}" src="images/detail/5d84ee3e.Detail_icon01.svg"><img if="{fes.features.singing}" src="images/detail/359f9b9d.Detail_icon02.svg"><img if="{fes.features.drum}" src="images/detail/8c8fc759.Detail_icon03.svg"><img if="{fes.features.musicalPerformance}" src="images/detail/2ed5963e.Detail_icon04.svg"><img if="{fes.features.foodTruck}" src="images/detail/762ec244.Detail_icon05.svg"><img if="{fes.features.fireworks}" src="images/detail/f3c0c8cb.Detail_icon06.svg"></div><dl class="fes-infos matsuri-style"><dt>会 場</dt><dd>{fes.location.name}</dd><dt>住 所</dt><dd>{fes.location.city}{fes.location.address}</dd><dt>内 容</dt><dd><ul><li><span if="{fes.features.dancing}">踊り </span><span if="{fes.features.singing}">歌唱 </span><span if="{fes.features.drum}">太鼓 </span><span if="{fes.features.musicalPerformance}">演奏 </span><span if="{fes.features.foodTruck}">屋台 </span><span if="{fes.features.fireworks}">花火 </span></li><li each="{program in fes.features.others}">{program}</li><li each="{program in fes.features.specialProgram}">{program}</li></ul></dd><dt>URL</dt><dd><a href="{fes.url}" target="_blank">{fes.url}</a></dd><dt>備 考</dt><dd>{fes.remarks}</dd></dl></div><div id="map-detail"></div><div class="title matsuri-style">周辺のお祭り</div><fes-list feslist="{aroundFes}"></fes-list></article></div>','fes-detail .info-area, [riot-tag="fes-detail"] .info-area{ margin-left: 10px; margin-right: 10px; } fes-detail .detail-title, [riot-tag="fes-detail"] .detail-title{ color: #E39727; font-weight: bold; font-size: 36px; line-height: 1.2em; margin-bottom: 20px; } fes-detail .info-area .day-time, [riot-tag="fes-detail"] .info-area .day-time{ border-top: 1px solid #ccc; border-bottom: 1px solid #ccc; padding-bottom: 20px; padding-top: 20px; } fes-detail .info-area .day-time li, [riot-tag="fes-detail"] .info-area .day-time li{ float: left; margin-right: 30px; } fes-detail .info-area .day-time .date, [riot-tag="fes-detail"] .info-area .day-time .date{ font-size: 26px; font-family: \'Merriweather\', serif; font-weight: 400; margin-right: 8px; } fes-detail .info-area .day-time .day-of-week, [riot-tag="fes-detail"] .info-area .day-time .day-of-week{ font-size: 18px; margin-right: 10px; } fes-detail .info-area .day-time .sat, [riot-tag="fes-detail"] .info-area .day-time .sat{ color: #3aa3e6; } fes-detail .info-area .day-time .sun, [riot-tag="fes-detail"] .info-area .day-time .sun{ color: #E10003; } fes-detail .info-area .day-time .clock, [riot-tag="fes-detail"] .info-area .day-time .clock{ font-family: "Times New Roman", Times, serif; font-size: 24px; } fes-detail .info-area .day-time:after, [riot-tag="fes-detail"] .info-area .day-time:after{ content: "."; display: block; height: 0; font-size: 0; clear: both; visibility: hidden; } fes-detail .info-area .weather, [riot-tag="fes-detail"] .info-area .weather{ border-bottom: 1px solid #ccc; margin-bottom: 30px; padding-bottom: 20px; padding-top: 20px; } fes-detail .info-area .weather ul:after, [riot-tag="fes-detail"] .info-area .weather ul:after{ content: "."; display: block; height: 0; font-size: 0; clear: both; visibility: hidden; } fes-detail .info-area .weather li, [riot-tag="fes-detail"] .info-area .weather li{ float: left; text-align: center; margin-right: 30px; } fes-detail .info-area .weather .temperatureMax, [riot-tag="fes-detail"] .info-area .weather .temperatureMax{ font-weight: bold; color: #ff3300; } fes-detail .info-area .weather .temperatureMin, [riot-tag="fes-detail"] .info-area .weather .temperatureMin{ font-weight: bold; color: #0066ff; } fes-detail .info-area .features, [riot-tag="fes-detail"] .info-area .features{ clear: both; margin-bottom: 30px; } fes-detail .info-area .features img, [riot-tag="fes-detail"] .info-area .features img{ width: 120px; } fes-detail .info-area .fes-infos, [riot-tag="fes-detail"] .info-area .fes-infos{ clear: both; } fes-detail .info-area .fes-infos dt, [riot-tag="fes-detail"] .info-area .fes-infos dt{ float: left; border: solid 1px #A0A0A0; font-size: 13px; padding: 1px 30px; border-radius: 10px; clear: left; margin-bottom: 20px; } fes-detail .info-area .fes-infos dd, [riot-tag="fes-detail"] .info-area .fes-infos dd{ padding-left: 120px; margin-bottom: 20px; } fes-detail #map-detail, [riot-tag="fes-detail"] #map-detail{ height: 250px; width: 100%; margin-bottom: 30px; } fes-detail .content .title, [riot-tag="fes-detail"] .content .title{ background-color: #F4A838; color: #ffffff; padding: 10px; font-size: 24px; margin-bottom: 30px; } @media only screen and (max-width: 640px){ fes-detail .info-area .detail-title, [riot-tag="fes-detail"] .info-area .detail-title{ font-size: 28px; } fes-detail .info-area .features img, [riot-tag="fes-detail"] .info-area .features img{ width: 33.3%; } fes-detail .info-area .fes-infos dt, [riot-tag="fes-detail"] .info-area .fes-infos dt{ float: none; text-align: center; margin-bottom: 10px; } fes-detail .info-area .fes-infos dd, [riot-tag="fes-detail"] .info-area .fes-infos dd{ padding-left: 0px; } }',function(a){
var b=this;b.fes=null,b.aroundFes=[];var c=null,d=L.map(b["map-detail"],{dragging:!0});L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png",{maxZoom:18,subdomains:["otile1","otile2","otile3","otile4"],attribution:'Tiles courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png">. Map data (c) <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, CC-BY-SA.'}).addTo(d),riot.route.on("routeChange:detail",function(a){cfc.Event.findOne(a).done(function(a){b.fes=a,b.update(),c&&d.removeLayer(c);var e=L.icon({iconUrl:"images/535fb118.marker-icon.png",iconSize:[30,40]});c=L.marker([a.location.lat,a.location["long"]],{icon:e}),c.addTo(d),d.setView([a.location.lat,a.location["long"]],14),b.fetchAroundRes(a),b.fetchWeather(a)})}),this.fetchAroundRes=function(a){var c=L.latLng([a.location.lat,a.location["long"]]),d={fromDate:new Date,basePoint:c,distance:5e3,limit:10,pageNo:0,order:"periods"};cfc.Event.find(d).done(function(c){b.aroundFes=_.filter(c.list,function(b){return a.id!==b.id}),b.update()})}.bind(this),this.fetchWeather=function(a){_.each(a.periods,function(a){cfc.Weather.findByDate(a.start).done(function(c){a.weather=c,b.update()})})}.bind(this),this.onSelectFes=function(a){riot.route("detail/"+a.item.fes.id)}.bind(this)}),riot.tag("fes-list",'<ul class="festival-list"><wrap each="{fes, i in opts.feslist}"><div class="clearfix" if="{i%3 === 0}"></div><li class="festival-list-date" onclick="{parent.onSelectFes}"><dl><dt><p class="day" if="{fes.getUniquePeriods().length <= 2}"><span class="bgcolor" each="{period in fes.getUniquePeriods()}" > {moment(period.start).format(\'MM/DD\')} <span class="small matsuri-style">{moment(period.start).format(\'dd\')}</span></span></p><p class="day" if="{fes.getUniquePeriods().length > 2}"><span class="bgcolor" > {moment(fes.getStartDate()).format(\'MM/DD\')} <span class="small matsuri-style">{moment(fes.getStartDate()).format(\'dd\')}</span> - {moment(fes.getUniquePeriods()[fes.getUniquePeriods().length - 1].start).format(\'MM/DD\')} <span class="small matsuri-style">{moment(fes.getUniquePeriods()[fes.getUniquePeriods().length - 1].start).format(\'dd\')}</span></span></p><p class="title matsuri-style">{fes.name}</p></dt><dd><a href="javascript:void(0)"><img class="roll_fout" riot-src="{fes.getImage()}"></a></dd></dl></li></wrap></ul>','fes-list .festival-list, [riot-tag="fes-list"] .festival-list{ padding: 0 20px; } fes-list .festival-list-date, [riot-tag="fes-list"] .festival-list-date{ width: 300px; float: left; margin-right: 30px; margin-bottom: 30px; } fes-list .festival-list-date .day, [riot-tag="fes-list"] .festival-list-date .day{ font-size: 26px; font-family: \'Merriweather\', serif; font-weight: 400; color: #fff; margin-bottom: 3px; letter-spacing: 0.1em; } fes-list .festival-list-date .day .small, [riot-tag="fes-list"] .festival-list-date .day .small{ font-size: 18px; } fes-list .festival-list-date .day .bgcolor, [riot-tag="fes-list"] .festival-list-date .day .bgcolor{ background: #dc79a2; padding: 6px; margin-right: 5px; } fes-list .festival-list-date .title, [riot-tag="fes-list"] .festival-list-date .title{ background: #4c4c4c; padding: 8px; font-size: 26px; font-weight: bold; color: #fff; margin-bottom: 0; } fes-list wrap:nth-child(3n) .festival-list-date, [riot-tag="fes-list"] wrap:nth-child(3n) .festival-list-date{ margin-right: 0px; } fes-list .festival-list:after, [riot-tag="fes-list"] .festival-list:after{ content: "."; display: block; height: 0; font-size: 0; clear: both; visibility: hidden; } @media only screen and (max-width: 640px){ fes-list .festival-list, [riot-tag="fes-list"] .festival-list{ padding: 0; } fes-list .festival-list-date, [riot-tag="fes-list"] .festival-list-date{ width: 100%; float: none; position: relative; margin-right: 0; margin-bottom: 1px; } fes-list .festival-list-date dt, [riot-tag="fes-list"] .festival-list-date dt{ position: absolute; top: 20px; left: 10px; } fes-list .festival-list-date dt .day, [riot-tag="fes-list"] .festival-list-date dt .day{ font-size: 18px; font-family: \'Merriweather\', serif; font-weight: 400; color: #fff; margin-bottom: 5px; letter-spacing: 0.1em; } fes-list .festival-list-date dt .day .small, [riot-tag="fes-list"] .festival-list-date dt .day .small{ font-size: 14px; } fes-list .festival-list-date dt .day .bgcolor, [riot-tag="fes-list"] .festival-list-date dt .day .bgcolor{ background: #dc79a2; padding: 8px; } fes-list .festival-list-date dt .title, [riot-tag="fes-list"] .festival-list-date dt .title{ background: #4c4c4c; padding: 8px; font-size: 18px; font-weight: bold; color: #fff; margin-bottom: 0; } fes-list .festival-list-date dd, [riot-tag="fes-list"] .festival-list-date dd{ height: 110px; overflow: hidden; background: #383838; } fes-list .festival-list-date dd img, [riot-tag="fes-list"] .festival-list-date dd img{ width: 100%; } fes-list wrap:nth-child(3n) .festival-list-date, [riot-tag="fes-list"] wrap:nth-child(3n) .festival-list-date{ margin-right: 6%; } fes-list wrap:nth-child(2n) .festival-list-date, [riot-tag="fes-list"] wrap:nth-child(2n) .festival-list-date{ margin-right: 0; } }',function(a){this.onSelectFes=function(a){riot.route("detail/"+a.item.fes.id)}.bind(this),this.on("updated",function(){Ts.reload()})}),riot.tag("fes-map",'<div id="map-result"></div>',function(a){function b(a,b){c.setView([a,b],12);var d=L.icon({iconUrl:"images/809aeb50.icon_pointer_360.png",iconRetinaUrl:"images/809aeb50.icon_pointer_360.png",iconSize:[50,50],iconAnchor:[25,25],popupAnchor:[0,0]}),e={icon:d,clickable:!1,draggable:!1,opacity:.9};L.marker([a,b],e).addTo(c)}var c=L.map(this["map-result"],{dragging:!0});L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png",{maxZoom:18,subdomains:["otile1","otile2","otile3","otile4"],attribution:'Tiles courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png">. Map data (c) <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, CC-BY-SA.'}).addTo(c);var d=L.markerClusterGroup();d.addTo(c),this.on("show",function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){b(a.coords.latitude,a.coords.longitude)},function(a){b(35.6098733,140.1138984)},{enableHighAccuracy:!0,timeout:8e3,maximumAge:0}):b(35.6098733,140.1138984)}),this.on("update",function(){d.clearLayers();var b=L.icon({iconUrl:"images/535fb118.marker-icon.png",iconSize:[30,40]});_.each(a.feslist,function(a){var c=L.marker(new L.LatLng(a.location.lat,a.location["long"]),{icon:b}).bindLabel(a.name,{noHide:!0,clickable:!0});c.on("click",function(b){riot.route("detail/"+a.id)}),c.label.on("click",function(b){riot.route("detail/"+a.id)}),d.addLayer(c)})})}),function(){"use strict";riot.route.parser(function(a){var b=a.split("?"),c=[b[0]],d=b[1],e={};return d&&d.split("&").forEach(function(a){var b=a.split("=");if(b[0].indexOf("%5B%5D")>=0){var c=b[0].replace("%5B%5D","");e[c]||(e[c]=[]),e[c].push(b[1])}else e[b[0]]=b[1]}),c.push(e),c}),riot.route.currentPath=function(){var a=location.href.match(/#([^\?]*)/);return a.length>1?a[1]:""},riot.observable(riot.route);var a="",b=null,c=function(c,d){c=c||"home";var e=c.split("/"),f=a.split("/");m(function(){for(var g="",h=0;h<e.length;h++){var i=e[h],j=f[h];i!==j?(riot.route.trigger("routeChange"+(""===g?"":":")+g,i),g+=(""===g?"":"/")+i,riot.route.trigger(g,d)):_.isEqual(d,b)?g+=(""===g?"":"/")+i:(g+=(""===g?"":"/")+i,riot.route.trigger(g,d))}a=c,b=d})},d=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/MSIE/),e=!1,f="Webkit Moz O ms Khtml".split(" "),g=document.createElement("div");if(void 0!==g.style.animationName&&(e=!0),!e)for(var h=0;h<f.length;h++)if(void 0!==g.style[f[h]+"AnimationName"]){e=!0;break}var i={display:"block",opacity:0,position:"absolute",left:e?"0px":"20px",right:0,top:0,bottom:0},j={left:"0px",opacity:1},k={left:"",top:"",right:"",bottom:"",position:"",opacity:""},l=function(a){a.removeClass("entrance-in entrance-out")},m=function(a){var b=$("body"),c=function(){b.scrollTop(0),a&&a(),b.css(i),e?(l(b),b.addClass("entrance-in"),setTimeout(function(){l(b),b.css(k)},500)):b.animate(j,{duration:500,easing:"swing",always:function(){b.css(k)}})};e&&!d?(l(b),b.addClass("entrance-out"),setTimeout(c,100)):b.fadeOut({duration:100,always:c})};riot.route.attacheExec=function(a,b){a=$(a);var c=setInterval(function(){a.length&&a.is(":visible")&&(clearInterval(c),b())},50)},riot.route(c),riot.route.build=function(){$("body").hide(),this.exec(c)}}(),function(a){"use strict";var b=function(){};b.prototype={dataStore:null,findAll:function(){if(this.dataStore){var a=new $.Deferred;return a.resolve(_.values(this.dataStore)),a.promise()}var b=this;return this.getJSON(this.url).then(function(a){return b.dataStore={},b.storeData(a),_.values(b.dataStore)})},storeData:function(a){},findOne:function(a){var b=this;if(this.dataStore){var c=new $.Deferred,d=b.dataStore[a];return d?c.resolve(d):c.reject(),c.promise()}return this.findAll().then(function(){var c=new $.Deferred,d=b.dataStore[a];return d?c.resolve(d):c.reject(),c.promise()})},getJSON:function(a){return $.getJSON(a)},_jsonp:function(a,b){var c=document.createElement("script");c.async=!0;var d="exec"+Math.floor(65535*Math.random()+1);window[d]=function(a){var c=document.getElementById(d);c.parentNode.removeChild(c),b(a),window[d]=null,delete window[d]};var e=a.indexOf("?")>-1?"&":"?";c.src=a+e+"callback="+d,c.id=d,document.getElementsByTagName("head")[0].appendChild(c)}},a.StoreBase=b}(window.cfc=window.cfc||{}),function(a){"use strict";var b=function(){};b.prototype={url:"http://codeforchiba.github.io/feschibal/data/chiba_festival.json",storeData:function(a){_.each(a,function(a){a.periods=_.map(a.periods,function(a){return a.start=new Date(a.start),a.end=new Date(a.end),a}),this.dataStore[a.id]=new cfc.Event(a)},this)}},_.defaults(b.prototype,cfc.StoreBase.prototype),a.EventStore=b}(window.cfc=window.cfc||{}),function(a){"use strict";var b=function(){};b.prototype={url:"http://codeforchiba.github.io/feschibal/data/12chiba.json",storeData:function(a){_.each(a,function(a){this.dataStore[a.addressCode]=new cfc.City(a)},this)}},_.defaults(b.prototype,cfc.StoreBase.prototype),a.CityStore=b}(window.cfc=window.cfc||{}),function(a){"use strict";var b=function(){};b.prototype={url:"http://api.yumake.jp/1.0/forecastPrefWeek.php?code=12&key=a2cdd9beea377b2846bb0268ca336c6b&format=jsonp",storeData:function(a){for(var b=new Date(a.reportDateTime),c=0;7>c;c++){var d=new cfc.Weather;d.reportDateTime=b,d.forecastDateTime=new Date(a.area[0].forecastDateTime[c]),d.weather=a.area[0].weather[c],d.weatherCode=a.area[0].weatherCode[c],d.precipitation=a.area[0].precipitation[c],d.temperatureMax=a.area[0].temperatureMax[c],d.temperatureMin=a.area[0].temperatureMin[c];var e=this._getDateKey(d.forecastDateTime);this.dataStore[e]=d}},getJSON:function(a){var b=new $.Deferred;return this._jsonp(a,function(a){b.resolve(a)}),b.promise()},_getDateKey:function(a){return moment(a).format("YYYYMMDD")},findByDate:function(a){var b=this._getDateKey(a);return this.findOne(b)}},_.defaults(b.prototype,cfc.StoreBase.prototype),a.WeatherStore=b}(window.cfc=window.cfc||{}),function(a){"use strict";var b=function(a){return 1e4*a.getYear()+100*a.getMonth()+a.getDate()},c=function(a){for(var b in a)this[b]=a[b]};c.prototype={getStartDate:function(){return this.periods[0].start},getEndDate:function(){return this.periods[this.periods.length-1].end},getImage:function(){return this.image||"images/common/15953526.pic01.jpg"},getUniquePeriods:function(){return _.uniq(this.periods,function(a){return a.start.getMonth()+"-"+a.start.getDay()})}},c.dataStore=new cfc.EventStore,c.findAll=function(){return this.dataStore.findAll()},c.find=function(a){return this.findAll().then(function(c){return _.filter(c,function(c){var d=!1;if(a.fromDate){var e=b(a.fromDate);if(d=_.some(c.periods,function(a){return b(a.start)>=e}),!d)return!1}if(a.toDate){var f=b(a.toDate);if(d=_.some(c.periods,function(a){return b(a.start)<=f}),!d)return!1}if(a.basePoint&&null!=a.distance){var g=L.latLng([c.location.lat,c.location["long"]]);if(c.distance=g.distanceTo(a.basePoint),c.distance>a.distance)return!1}if(a.cities&&a.cities.length>0){var d=_.some(a.cities,function(a){return c.location.addressCode.indexOf(a)>=0});if(!d)return!1}return!0})}).then(function(b){return null!=a.order&&"periods"===a.order?_.sortBy(b,function(a){return a.getStartDate().getTime()}):null!=a.order?_.sortBy(b,a.order):b}).then(function(b){if(null!=a.limit&&null!=a.pageNo){var c=a.limit*a.pageNo,d=a.limit*(a.pageNo+1)-1;return{total:b.length,limit:a.limit,pageNo:a.pageNo,list:_.filter(b,function(a,b){return b>=c&&d>=b})}}return{total:b.length,list:b}})},c.findOne=function(a){return this.dataStore.findOne(a)},a.Event=c}(window.cfc=window.cfc||{}),function(a){"use strict";var b=function(a){for(var b in a)this[b]=a[b]};b.prototype={getTowns:function(){var a=this;return b.dataStore.findAll().then(function(b){return _.filter(b,function(b){return b.addressCode.lastIndexOf("0000")<0&&a.cityCode===b.cityCode})})},isWard:function(){return this.addressCode.lastIndexOf("0000")>=0}},b.dataStore=new cfc.CityStore,b.findAll=function(){return this.dataStore.findAll()},b.findOne=function(a){return this.dataStore.findOne(a)},b.findAllWards=function(){return this.dataStore.findAll().then(function(a){return _.filter(a,function(a){return a.isWard()})})},a.City=b}(window.cfc=window.cfc||{}),function(a){"use strict";var b=function(a){};b.prototype={reportDateTime:null,forecastDateTime:null,weather:null,weatherCode:null,precipitation:null,temperatureMax:null,temperatureMin:null},b.dataStore=new cfc.WeatherStore,b.findByDate=function(a){return this.dataStore.findByDate(a)},a.Weather=b}(window.cfc=window.cfc||{});